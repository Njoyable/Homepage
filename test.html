<!DOCTYPE html>
<html>

<head>
    <title>CSV Editor</title>
</head>

<body>
    <h1>CSV Editor</h1>
    <label for="newEntry">Add Entry:</label>
    <input type="text" id="newEntry" />
    <button onclick="addEntry()">Add to CSV</button>
    <hr />
    <div id="output"></div>

    <script>
        window.onload = function () {
            readCSV();
        };

        function readCSV() {
            const csvFilePath = 'ha_spots.csv';
            fetch(csvFilePath)
                .then(response => response.text())
                .then(csvText => {
                    const lines = csvText.split('\n');
                    let output = '';

                    lines.forEach((line) => {
                        const entries = line.split(',');
                        output += entries.join(', ') + '<br>';
                    });

                    document.getElementById('output').innerHTML = output;
                })
                .catch(error => {
                    document.getElementById('output').innerText = 'Error occurred while fetching the file.';
                });
        }

        function addEntry() {
            const newEntry = document.getElementById('newEntry').value.trim();
            if (newEntry !== '') {
                const csvFilePath = 'ha_spots.csv';
                fetch(csvFilePath, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'text/plain'
                    },
                    body: newEntry + '\n'
                })
                    .then(response => {
                        if (response.ok) {
                            readCSV();
                            document.getElementById('newEntry').value = '';
                        } else {
                            throw new Error('Error occurred while adding the entry.');
                        }
                    })
                    .catch(error => {
                        console.error(error);
                    });
            }
        }
    </script>
</body>

</html>
